{% assign recommended_products = product.metafields.custom.recommendations.value %}
{% assign count = recommended_products | map: "id" | size %}

{% if recommended_products and count > 0 %}
  <div class="recommended-products" style="margin-top: 48px;">
    <div class="page-width">
      <h2 style="font-size: 24px; margin-bottom: 20px; text-align: center;">You May Also Like</h2>

      <div style="
        display: flex;
        gap: 16px;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 8px;
      ">
        {% for product in recommended_products %}
          <div style="
            flex: 0 0 auto;
            width: 220px;
            scroll-snap-align: center;
            border: 1px solid #eee;
            border-radius: 12px;
            padding: 12px;
            background: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            text-align: center;
            transition: box-shadow 0.3s ease;
          " onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)'" onmouseout="this.style.boxShadow='0 2px 6px rgba(0,0,0,0.05)'">
            <a href="{{ product.url }}" style="text-decoration: none; color: inherit; display: block;">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 400 }}"
                  alt="{{ product.title | escape }}"
                  style="width: 100%; border-radius: 8px; margin-bottom: 8px; transition: transform 0.3s;"
                  onmouseover="this.style.transform='scale(1.03)'"
                  onmouseout="this.style.transform='scale(1)'"
                >
              {% endif %}
              <p style="font-size: 16px; margin: 4px 0; font-weight: 500;">{{ product.title }}</p>
              {% if product.price %}
                <p style="font-weight: 600; color: #333; font-size: 14px;">{{ product.price | money }}</p>
              {% endif %}
              <span style="
                display: inline-block;
                margin-top: 8px;
                padding: 6px 12px;
                font-size: 14px;
                background-color: #f5f5f5;
                border-radius: 6px;
                transition: background 0.2s;
              ">View Product</span>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endif %}
